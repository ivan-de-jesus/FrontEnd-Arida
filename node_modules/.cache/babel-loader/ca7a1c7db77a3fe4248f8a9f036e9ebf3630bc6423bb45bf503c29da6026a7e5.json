{"ast":null,"code":"import { ref, onMounted, toRefs } from 'vue';\nimport { Carousel } from 'bootstrap';\nimport MapView from '@/components/MapView.vue';\n\n/* --- props que llegan desde LandingView ------------------------------ */\n\nexport default {\n  __name: 'FlowCarousel',\n  props: {\n    coords: {\n      type: Object,\n      required: true\n    },\n    // { latitude, longitude }\n    preview: {\n      type: String,\n      required: true\n    } // blob/url miniatura\n  },\n  setup(__props) {\n    const props = __props;\n    const {\n      coords,\n      preview\n    } = toRefs(props); // ← ¡clave!\n\n    /* --- estado interno --------------------------------------------------- */\n    const step = ref(1); // 1 = miniatura  / 2 = mapa\n    const ndwi = ref(null);\n    const status = ref(null);\n    const loading = ref(false);\n\n    /* --- Bootstrap Carousel ---------------------------------------------- */\n    const carouselEl = ref(null);\n    let bsCarousel;\n    onMounted(() => {\n      bsCarousel = new Carousel(carouselEl.value, {\n        touch: true,\n        interval: false\n      });\n    });\n    function goToMap() {\n      loading.value = true;\n      step.value = 2;\n      bsCarousel.next();\n    }\n    function updateNdwiStatus({\n      ndwi: n,\n      status: s\n    }) {\n      ndwi.value = n;\n      status.value = s;\n      loading.value = false;\n    }\n    return {\n      __sfc: true,\n      props,\n      coords,\n      preview,\n      step,\n      ndwi,\n      status,\n      loading,\n      carouselEl,\n      bsCarousel,\n      goToMap,\n      updateNdwiStatus,\n      MapView\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","toRefs","Carousel","MapView","coords","preview","props","step","ndwi","status","loading","carouselEl","bsCarousel","value","touch","interval","goToMap","next","updateNdwiStatus","n","s"],"sources":["FlowCarousel.vue"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted, toRefs } from 'vue'\r\nimport { Carousel }   from 'bootstrap'\r\nimport MapView        from '@/components/MapView.vue'\r\n\r\n/* --- props que llegan desde LandingView ------------------------------ */\r\nconst props = defineProps({\r\n  coords:  { type: Object, required: true },   // { latitude, longitude }\r\n  preview: { type: String, required: true }    // blob/url miniatura\r\n})\r\nconst { coords, preview } = toRefs(props)      // ← ¡clave!\r\n\r\n/* --- estado interno --------------------------------------------------- */\r\nconst step    = ref(1)     // 1 = miniatura  / 2 = mapa\r\nconst ndwi    = ref(null)\r\nconst status  = ref(null)\r\nconst loading = ref(false)\r\n\r\n/* --- Bootstrap Carousel ---------------------------------------------- */\r\nconst carouselEl = ref(null)\r\nlet bsCarousel\r\nonMounted(() => {\r\n  bsCarousel = new Carousel(carouselEl.value, { touch: true, interval: false })\r\n})\r\n\r\nfunction goToMap () {\r\n  loading.value = true\r\n  step.value    = 2\r\n  bsCarousel.next()\r\n}\r\n\r\nfunction updateNdwiStatus ({ ndwi: n, status: s }) {\r\n  ndwi.value   = n\r\n  status.value = s\r\n  loading.value = false\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div\r\n    id=\"flowCarousel\"\r\n    class=\"carousel slide\"\r\n    data-bs-touch=\"true\"\r\n    :data-bs-interval=\"false\"\r\n    ref=\"carouselEl\"\r\n  >\r\n    <!-- indicadores (solo 2 dots) -->\r\n    <div class=\"carousel-indicators\">\r\n      <button\r\n        v-for=\"n in 2\"\r\n        :key=\"n\"\r\n        type=\"button\"\r\n        :data-bs-target=\"'#flowCarousel'\"\r\n        :data-bs-slide-to=\"n - 1\"\r\n        :class=\"{ active: step === n }\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"carousel-inner\">\r\n      <!-- DIAPOSITIVA 1 · Miniatura -->\r\n      <div class=\"carousel-item active\">\r\n        <div class=\"card p-3 text-center\">\r\n          <img :src=\"preview\" class=\"img-fluid rounded mb-3\" />\r\n          <p class=\"mb-4\">\r\n            <strong>Coordenadas:</strong><br />\r\n            {{ coords.latitude.toFixed(5) }},\r\n            {{ coords.longitude.toFixed(5) }}\r\n          </p>\r\n          <button class=\"btn btn-success w-100\" @click=\"goToMap\">\r\n            Ver mapa\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- DIAPOSITIVA 2 · Mapa -->\r\n      <div class=\"carousel-item\">\r\n        <transition name=\"fade\">\r\n          <MapView\r\n            v-if=\"step === 2\"\r\n            :coords=\"coords\"\r\n            @ndwi-status=\"updateNdwiStatus\"\r\n          />\r\n        </transition>\r\n\r\n        <div class=\"mt-3 card p-3\">\r\n          <h5>Estado de humedad</h5>\r\n          <div v-if=\"loading\" class=\"text-center\">Calculando NDWI…</div>\r\n          <div v-else>\r\n            <p v-if=\"status\">\r\n              <strong>{{ status }}</strong>\r\n              <span v-if=\"ndwi !== null\"> – NDWI: {{ ndwi.toFixed(2) }}</span>\r\n            </p>\r\n            <p v-else class=\"text-muted\">No se pudo calcular NDWI</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.carousel-indicators [data-bs-target] {\r\n  width: 6px; height: 6px; border-radius: 50%; background: #999; margin: 0 4px;\r\n}\r\n.carousel-indicators .active { background: #000 }\r\n.fade-enter-active,.fade-leave-active{transition:opacity .35s}\r\n.fade-enter,.fade-leave-to{opacity:0}\r\n</style>\r\n"],"mappings":"AACA,SAASA,GAAG,EAAEC,SAAS,EAAEC,MAAM,QAAQ,KAAK;AAC5C,SAASC,QAAQ,QAAU,WAAW;AACtC,OAAOC,OAAO,MAAa,0BAA0B;;AAErD;;;;;;;;;;;;;;;;;IAKA,MAAM;MAAEC,MAAM;MAAEC;IAAQ,CAAC,GAAGJ,MAAM,CAACK,KAAK,CAAC,EAAM;;IAE/C;IACA,MAAMC,IAAI,GAAMR,GAAG,CAAC,CAAC,CAAC,EAAK;IAC3B,MAAMS,IAAI,GAAMT,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMU,MAAM,GAAIV,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMW,OAAO,GAAGX,GAAG,CAAC,KAAK,CAAC;;IAE1B;IACA,MAAMY,UAAU,GAAGZ,GAAG,CAAC,IAAI,CAAC;IAC5B,IAAIa,UAAU;IACdZ,SAAS,CAAC,MAAM;MACdY,UAAU,GAAG,IAAIV,QAAQ,CAACS,UAAU,CAACE,KAAK,EAAE;QAAEC,KAAK,EAAE,IAAI;QAAEC,QAAQ,EAAE;MAAM,CAAC,CAAC;IAC/E,CAAC,CAAC;IAEF,SAASC,OAAOA,CAAA,EAAI;MAClBN,OAAO,CAACG,KAAK,GAAG,IAAI;MACpBN,IAAI,CAACM,KAAK,GAAM,CAAC;MACjBD,UAAU,CAACK,IAAI,CAAC,CAAC;IACnB;IAEA,SAASC,gBAAgBA,CAAE;MAAEV,IAAI,EAAEW,CAAC;MAAEV,MAAM,EAAEW;IAAE,CAAC,EAAE;MACjDZ,IAAI,CAACK,KAAK,GAAKM,CAAC;MAChBV,MAAM,CAACI,KAAK,GAAGO,CAAC;MAChBV,OAAO,CAACG,KAAK,GAAG,KAAK;IACvB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}