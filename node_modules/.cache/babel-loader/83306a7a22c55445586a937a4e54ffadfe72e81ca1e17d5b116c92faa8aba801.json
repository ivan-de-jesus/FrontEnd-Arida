{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport PhotoCapture from '@/components/PhotoCapture.vue';\nimport MapView from '@/components/MapView.vue';\nimport { Carousel } from 'bootstrap';\n\n/* --- estado --- */\n\nexport default {\n  __name: 'FlowCarousel',\n  setup(__props) {\n    const step = ref(1); // 1,2,3\n    const coords = ref(null); // {lat, lng}\n    const photoPreview = ref(null); // base64 o blob url\n    const ndwi = ref(null);\n    const status = ref(null);\n    const loading = ref(false);\n\n    /* --- referencia al DOM para controlar el carrusel --- */\n    const carouselEl = ref(null);\n    let bsCarousel;\n    onMounted(() => {\n      bsCarousel = new Carousel(carouselEl.value, {\n        touch: true,\n        interval: false\n      });\n    });\n\n    /* --- callbacks --- */\n    function afterCapture({\n      coords: c,\n      preview\n    }) {\n      coords.value = c;\n      photoPreview.value = preview;\n      nextSlide(); // pasamos al paso 2\n    }\n    function goToMap() {\n      loading.value = true;\n      ndwi.value = null;\n      status.value = null;\n      nextSlide(); // paso 3\n    }\n    function updateNdwiStatus({\n      ndwi: n,\n      status: s\n    }) {\n      ndwi.value = n;\n      status.value = s;\n      loading.value = false;\n    }\n\n    /* --- helpers --- */\n    function nextSlide() {\n      step.value += 1;\n      bsCarousel.next();\n    }\n    return {\n      __sfc: true,\n      step,\n      coords,\n      photoPreview,\n      ndwi,\n      status,\n      loading,\n      carouselEl,\n      bsCarousel,\n      afterCapture,\n      goToMap,\n      updateNdwiStatus,\n      nextSlide,\n      PhotoCapture,\n      MapView\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","PhotoCapture","MapView","Carousel","step","coords","photoPreview","ndwi","status","loading","carouselEl","bsCarousel","value","touch","interval","afterCapture","c","preview","nextSlide","goToMap","updateNdwiStatus","n","s","next"],"sources":["FlowCarousel.vue"],"sourcesContent":["<template>\r\n  <!-- CAROUSEL CONTENEDOR -->\r\n  <div\r\n    id=\"flowCarousel\"\r\n    class=\"carousel slide\"\r\n    data-bs-touch=\"true\"\r\n    :data-bs-interval=\"false\"\r\n    ref=\"carouselEl\"\r\n  >\r\n    <!-- INDICADORES ...  -->\r\n    <div class=\"carousel-indicators\">\r\n      <button\r\n        v-for=\"n in 3\"\r\n        :key=\"n\"\r\n        type=\"button\"\r\n        :data-bs-target=\"'#flowCarousel'\"\r\n        :data-bs-slide-to=\"n - 1\"\r\n        :class=\"{ active: step === n }\"\r\n        aria-current=\"true\"\r\n      />\r\n    </div>\r\n\r\n    <!-- DIAPOSITIVAS -->\r\n    <div class=\"carousel-inner\">\r\n\r\n      <!-- PASO 1 ─ Subir imagen -->\r\n      <div class=\"carousel-item\" :class=\"{ active: step === 1 }\">\r\n        <div class=\"container py-4\" style=\"max-width: 680px\">\r\n          <PhotoCapture\r\n            @captured=\"afterCapture\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- PASO 2 ─ Foto + coords + botón -->\r\n      <div class=\"carousel-item\" :class=\"{ active: step === 2 }\">\r\n        <div class=\"container py-4\" style=\"max-width: 680px\">\r\n          <div class=\"card p-3 text-center\">\r\n            <img\r\n              :src=\"photoPreview\"\r\n              alt=\"preview\"\r\n              class=\"img-fluid rounded mb-3\"\r\n            />\r\n            <p v-if=\"coords\" class=\"mb-4\">\r\n   <strong>Coordenadas:</strong><br />\r\n   {{ coords.lat.toFixed(5) }}, {{ coords.lng.toFixed(5) }}\r\n </p>\r\n            <button class=\"btn btn-success w-100\" @click=\"goToMap\">\r\n              Ver mapa\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- PASO 3 ─ Mapa + semáforo -->\r\n      <div class=\"carousel-item\" :class=\"{ active: step === 3 }\">\r\n        <div class=\"container py-4\" style=\"max-width: 680px\">\r\n          <transition name=\"fade\">\r\n            <MapView\r\n              v-if=\"coords\"\r\n              :coords=\"coords\"\r\n              @ndwi-status=\"updateNdwiStatus\"\r\n            />\r\n          </transition>\r\n\r\n          <div v-if=\"coords\" class=\"mt-3 card p-3\">\r\n            <h5>Estado de humedad</h5>\r\n            <div v-if=\"loading\" class=\"text-center\">Calculando NDWI…</div>\r\n            <div v-else>\r\n              <p v-if=\"status\">\r\n                <strong>{{ status }}</strong>\r\n                <span v-if=\"ndwi !== null\">\r\n                  – NDWI: {{ ndwi.toFixed(2) }}\r\n                </span>\r\n                <span\r\n                  class=\"ms-2 d-inline-block rounded-circle\"\r\n                  :style=\"{\r\n                    width: '12px',\r\n                    height: '12px',\r\n                    background: status === 'Húmedo' ? 'green'\r\n                              : status === 'Moderado' ? 'orange'\r\n                              : 'brown'\r\n                  }\"\r\n                />\r\n              </p>\r\n              <p v-else class=\"text-muted\">No se pudo calcular NDWI</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport PhotoCapture from '@/components/PhotoCapture.vue'\r\nimport MapView       from '@/components/MapView.vue'\r\nimport { Carousel }  from 'bootstrap'\r\n\r\n/* --- estado --- */\r\nconst step          = ref(1)       // 1,2,3\r\nconst coords        = ref(null)    // {lat, lng}\r\nconst photoPreview  = ref(null)    // base64 o blob url\r\nconst ndwi          = ref(null)\r\nconst status        = ref(null)\r\nconst loading       = ref(false)\r\n\r\n/* --- referencia al DOM para controlar el carrusel --- */\r\nconst carouselEl = ref(null)\r\nlet bsCarousel\r\n\r\nonMounted(() => {\r\n  bsCarousel = new Carousel(carouselEl.value, { touch: true, interval: false })\r\n})\r\n\r\n/* --- callbacks --- */\r\nfunction afterCapture({ coords: c, preview }) {\r\n  coords.value       = c\r\n  photoPreview.value = preview\r\n  nextSlide()        // pasamos al paso 2\r\n}\r\n\r\nfunction goToMap() {\r\n  loading.value = true\r\n  ndwi.value    = null\r\n  status.value  = null\r\n  nextSlide()   // paso 3\r\n}\r\n\r\nfunction updateNdwiStatus({ ndwi: n, status: s }) {\r\n  ndwi.value   = n\r\n  status.value = s\r\n  loading.value = false\r\n}\r\n\r\n/* --- helpers --- */\r\nfunction nextSlide() {\r\n  step.value += 1\r\n  bsCarousel.next()\r\n}\r\n</script>\r\n\r\n<style>\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: opacity .35s;\r\n}\r\n.fade-enter,\r\n.fade-leave-to {\r\n  opacity: 0;\r\n}\r\n\r\n/* Indicadores tipo “•••” pequeños y centrados */\r\n.carousel-indicators [data-bs-target] {\r\n  width: 6px;\r\n  height: 6px;\r\n  border-radius: 50%;\r\n  background-color: #999;\r\n  margin: 0 4px;\r\n}\r\n.carousel-indicators .active {\r\n  background-color: #000;\r\n}\r\n</style>\r\n"],"mappings":"AA+FA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,YAAY,MAAM,+BAA+B;AACxD,OAAOC,OAAO,MAAY,0BAA0B;AACpD,SAASC,QAAQ,QAAS,WAAW;;AAErC;;;;;IACA,MAAMC,IAAI,GAAYL,GAAG,CAAC,CAAC,CAAC,EAAO;IACnC,MAAMM,MAAM,GAAUN,GAAG,CAAC,IAAI,CAAC,EAAI;IACnC,MAAMO,YAAY,GAAIP,GAAG,CAAC,IAAI,CAAC,EAAI;IACnC,MAAMQ,IAAI,GAAYR,GAAG,CAAC,IAAI,CAAC;IAC/B,MAAMS,MAAM,GAAUT,GAAG,CAAC,IAAI,CAAC;IAC/B,MAAMU,OAAO,GAASV,GAAG,CAAC,KAAK,CAAC;;IAEhC;IACA,MAAMW,UAAU,GAAGX,GAAG,CAAC,IAAI,CAAC;IAC5B,IAAIY,UAAU;IAEdX,SAAS,CAAC,MAAM;MACdW,UAAU,GAAG,IAAIR,QAAQ,CAACO,UAAU,CAACE,KAAK,EAAE;QAAEC,KAAK,EAAE,IAAI;QAAEC,QAAQ,EAAE;MAAM,CAAC,CAAC;IAC/E,CAAC,CAAC;;IAEF;IACA,SAASC,YAAYA,CAAC;MAAEV,MAAM,EAAEW,CAAC;MAAEC;IAAQ,CAAC,EAAE;MAC5CZ,MAAM,CAACO,KAAK,GAASI,CAAC;MACtBV,YAAY,CAACM,KAAK,GAAGK,OAAO;MAC5BC,SAAS,CAAC,CAAC,EAAQ;IACrB;IAEA,SAASC,OAAOA,CAAA,EAAG;MACjBV,OAAO,CAACG,KAAK,GAAG,IAAI;MACpBL,IAAI,CAACK,KAAK,GAAM,IAAI;MACpBJ,MAAM,CAACI,KAAK,GAAI,IAAI;MACpBM,SAAS,CAAC,CAAC,EAAG;IAChB;IAEA,SAASE,gBAAgBA,CAAC;MAAEb,IAAI,EAAEc,CAAC;MAAEb,MAAM,EAAEc;IAAE,CAAC,EAAE;MAChDf,IAAI,CAACK,KAAK,GAAKS,CAAC;MAChBb,MAAM,CAACI,KAAK,GAAGU,CAAC;MAChBb,OAAO,CAACG,KAAK,GAAG,KAAK;IACvB;;IAEA;IACA,SAASM,SAASA,CAAA,EAAG;MACnBd,IAAI,CAACQ,KAAK,IAAI,CAAC;MACfD,UAAU,CAACY,IAAI,CAAC,CAAC;IACnB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}